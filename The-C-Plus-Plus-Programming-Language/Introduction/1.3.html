<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.32">
    <title>1.3 C++ 的设计 | C++ 程序设计语言</title><meta name="description" content="">
    <link rel="modulepreload" href="/The-C-Plus-Plus-Programming-Language/assets/app.fce06a0c.js"><link rel="modulepreload" href="/The-C-Plus-Plus-Programming-Language/assets/1.3.html.f936c116.js"><link rel="modulepreload" href="/The-C-Plus-Plus-Programming-Language/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/The-C-Plus-Plus-Programming-Language/assets/1.3.html.d066e4b0.js">
    <link rel="stylesheet" href="/The-C-Plus-Plus-Programming-Language/assets/style.fc712d7f.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/The-C-Plus-Plus-Programming-Language/" class=""><!----><span class="site-name">C++ 程序设计语言</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/The-C-Plus-Plus-Programming-Language/Introduction/" class="router-link-active" aria-label="导论"><!--[--><!--]--> 导论 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/The-C-Plus-Plus-Programming-Language/Basic%20Facilities/" class="" aria-label="第一部分：基本功能"><!--[--><!--]--> 第一部分：基本功能 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/The-C-Plus-Plus-Programming-Language/Introduction/" class="router-link-active" aria-label="导论"><!--[--><!--]--> 导论 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/The-C-Plus-Plus-Programming-Language/Basic%20Facilities/" class="" aria-label="第一部分：基本功能"><!--[--><!--]--> 第一部分：基本功能 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/" class="router-link-active sidebar-item sidebar-heading collapsible" aria-label="前言"><!--[--><!--]--> 前言 <!--[--><!--]--></a><!----></li><li><p class="sidebar-item sidebar-heading active collapsible">第一章 致读者 <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.1.html" class="sidebar-item" aria-label="1.1 本书的结构"><!--[--><!--]--> 1.1 本书的结构 <!--[--><!--]--></a><!----></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.2.html" class="sidebar-item" aria-label="1.2 学习C++"><!--[--><!--]--> 1.2 学习C++ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/The-C-Plus-Plus-Programming-Language/Introduction/1.3.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="1.3 C++ 的设计"><!--[--><!--]--> 1.3 C++ 的设计 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/The-C-Plus-Plus-Programming-Language/Introduction/1.3.html#_1-3-1-效率和结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.3.1 效率和结构"><!--[--><!--]--> 1.3.1 效率和结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/The-C-Plus-Plus-Programming-Language/Introduction/1.3.html#_1-3-2-哲学注记" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.3.2 哲学注记"><!--[--><!--]--> 1.3.2 哲学注记 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.4.html" class="sidebar-item" aria-label="1.4 历史注记"><!--[--><!--]--> 1.4 历史注记 <!--[--><!--]--></a><!----></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.5.html" class="sidebar-item" aria-label="1.5 C++的使用"><!--[--><!--]--> 1.5 C++的使用 <!--[--><!--]--></a><!----></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.6.html" class="sidebar-item" aria-label="1.6 C和C++"><!--[--><!--]--> 1.6 C和C++ <!--[--><!--]--></a><!----></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.7.html" class="sidebar-item" aria-label="1.7 有关在C++里编程的思考"><!--[--><!--]--> 1.7 有关在C++里编程的思考 <!--[--><!--]--></a><!----></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.8.html" class="sidebar-item" aria-label="1.8 忠告"><!--[--><!--]--> 1.8 忠告 <!--[--><!--]--></a><!----></li><li><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.9.html" class="sidebar-item" aria-label="1.9 参考文献"><!--[--><!--]--> 1.9 参考文献 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p class="sidebar-item sidebar-heading collapsible">第二章 C++概览 <span class="right arrow"></span></p><!----></li><li><p class="sidebar-item sidebar-heading collapsible">第三章 标准库概览 <span class="right arrow"></span></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="_1-3-c-的设计" tabindex="-1"><a class="header-anchor" href="#_1-3-c-的设计" aria-hidden="true">#</a> 1.3 C++ 的设计</h1><p>简单性是一个重要设计准则：如果在某个地方有一个选择，简化语言的定义或者简化编译器，那么我们一定选前者。当然，还有一个重要的考虑是保持与C的高度兼容性，这也就排除了对C语法的清理。</p><p>C++没有内部的高级数据类型，也没有高级的基本操作。举例来说，C++没有提供带有求逆运算的矩阵类型，也没有带拼接运算的字符串类型。如果某个用户需要一个类型，那么可以在语言本身之中定义它。事实上，定义新的通用或者专用类型就是在C++里最基本的程序设计活动。一个设计良好的用户定义类型与一个内部类型之间的差异仅仅在于其定义的方式，而不在其使用方式。在第三部分描述的标准库提供了许多这样的类型及其使用的例子。从用户的观点看，在内部类型和由标准库提供的类型之间的差异非常小。</p><p>在C++的设计中，极力避免了那些即使不用也会带来运行时间或者空间额外开销的特征。例如，要求必须在每个对象里存储某种“薄记信息”的结构被拒绝了。所以，如果你定义了一种由两个16位的量组成的结构，它将能放进一个32位的寄存器里。</p><p>C++被设计为能使用传统的编译和运行时的环境，也就是那种在UNIX上的C程序设计环境。幸运的是，C++从来没有被束缚于UNIX，它只是简单地采用UNIX和C作为一种语言、库、编译器、连接器、执行环境等之间关系的模型。这种最小化的模型帮助C++在几乎每个计算平台上取得了成功。然而，在那些提供了更多有意义的支持的环境里，使用C++当然就更好了，像动态装载、增量编译、类型定义数据库等都能得到很好的收敛，又不会影响语言本身。</p><p>C++的类型检查和数据隐藏特征依赖于编译时对程序的分析，以防止因为意外而破坏数据的情况。它们并不提供系统安全性或防止某些人有意地打破这些规则。它们当然可以随意使用而不会带来运行时额外的时间或空间开销。这种想法是很有用的，一种语言特征必须不仅是优美的，还是在真实程序的环境中能够负担起的东西。</p><p>有关C++设计的更系统和详尽的描述，请看[Stroustrup，1994]。</p><h2 id="_1-3-1-效率和结构" tabindex="-1"><a class="header-anchor" href="#_1-3-1-效率和结构" aria-hidden="true">#</a> 1.3.1 效率和结构</h2><p>C++是以C程序设计语言为基础开发出来的，除了少量例外，它继续维持了以C作为一个子集。作为基础语言，C++的C子集设计保证了在它的类型、运算、语句与计算机直接处理的对象（数、字符和地址）之间的紧密对应关系。除了new、delete、dynamic_cast，以及throw运算符和try-块之外，C++的各种表达式和语句都不需要特殊的运行时支持。</p><p>C++可以使用与C一样的函数调用及返回序列---或者其他效率更高的方式。在这种相对有效的机制仍然被认为是代价过高之处，C++函数还可以采用在线替换，这样就使我们能在享受到函数记法上方便的同时，又不必付出任何运行时的开销。</p><p>C的一个初始目标是在大部分苛刻的系统程序设计工作中代替汇编语言。在设计C++时，也特别注意了不在这些已经取得的领域中做出任何妥协。在C和C++之间的差异，从根本上说，在于强调类型和结构的级别不同。C是有表达能力的和宽容的，而C++的表达能力更强。当然，为了获得这种增强的表达能力，你必须更多地关注对象的类型。知道了对象的类型，编译器就能正确处理表达式；如果不是这样，你就必须自己在令人难受的细节程度上去描述有关操作。知道了对象的类型，编译器就能检查错误；否则这些东西就会遗留下来直至测试阶段---或许留到更晚的时候。请注意，使用类型系统去检查函数的参数，去保护数据不被意外地破坏，去提供新的类型，去提供新的操作，如此等等。这些在C++里都没有增加任何运行时的时间或者空间开销。</p><p>C++中特别强调程序的结构，这反映了自C设计以来程序规模的增长情况。你可以通过玩命干做出一个小程序（比如说，1000行），甚至是在你违反了所有有关好风格的规则的情况下。而对于更大的程序，情况就完全不同了。如果一个100 000行的程序的结构及其糟糕，你就会发现，引进新错误的速度像清除老错误一样快。C++的设计就是为了使较大的程序能够以一种合理的方式构造出来，并因此使一个人也有可能对付相当大的一批代码。进一步的目标是使一个平均行的C++代码能够表述出远比一个平均行的C或Pascal代码更多的东西。C++已经证明它超过了这些目标。</p><p>并不是每块代码都可能是结构良好的，与硬件无关的，容易阅读的，如此等等。C++也拥有一些特征，其意图就是为了以一种直接了当和高效的方式去操纵硬件功能，而不顾安全性或者容易理解诸方面的问题。它还拥有一些特征，使得我们能够将这样的代码隐藏在优美和安全的界面之后。</p><p>很自然，对更大型的程序使用C++语言，将会导致由成组的程序员使用C++。C++所强调的模块化，强类型的界面，以及灵活性在这里都能发挥作用。C++在各种为写大程序而提供的功能之间做了很好的平衡，像其他任何语言一样好。当然，随着程序变得更大，与它们的开发和维护相关的问题也会逐渐从语言的问题转移到更为全局性的工具和管理的问题。第四部分将探讨这方面的论题。</p><p>本书强调的是为提供通用功能、普遍有用的类型、库等的各种技术。这些技术能为写小程序的程序员服务，也能为写大程序的程序员服务。进一步说，由于任何非平凡的程序都是由许多半独立的部分组成，写这些部分的技术定能服务于开发所有应用的程序员。</p><p>你或许会怀疑，用更细节的类型结构去刻画大程序，会不会导致更大的程序正文？对于C++而言情况并不是这样。一个声明了函数参数类型、使用了类等的C++程序，通常比没有使用这些功能的等价C程序短一点。在那些使用了库的地方，C++程序就要比等价的C程序短得多。当然了，这里还得假定那个功能等价的C程序确实能构造出来。</p><h2 id="_1-3-2-哲学注记" tabindex="-1"><a class="header-anchor" href="#_1-3-2-哲学注记" aria-hidden="true">#</a> 1.3.2 哲学注记</h2><p>一个程序设计语言要服务于两个相互关联的目的：它要为程序员提供一种描述所需执行的动作的载体；还要为程序员提供一组概念，使他们能利用这些概念去思考什么东西是能够做的。在理想的情况下，第一个用途要求一种“尽可能接近机器的”语言，以使机器的所有重要方面，都能以一种对程序员相当明显的方式简单而有效地加以处理。C语言的基本设计就是基于这一观点。而第二个用途所要求的理想语言是“尽可能接近需要解决的问题”，这样才能使解决方案中的概念能够直接而紧凑地表达出来。被加入C语言，从而塑造出C++的那些概念，从根本上说，就是基于这个观点设计的。</p><p>在我们思考／编程所用的语言和我们能够设想的问题与解之间的联系非常紧密。正是由于这个因素，以避免程序员犯错误为目的而对语言的特征加以限制，这一做法至少也是很危险的。就像自然语言中的情况，掌握至少两种语言就非常有价值。一个语言为程序员提供了一组概念工具；如果它们不适合于某件工作，程序员将简单地放弃这个语言。好的设计和不出现错误都不能仅由某些语言特征的存在或者不存在来保证。</p><p>类型系统对于各种各样非平凡的工作都特别有帮助。事实上，C++的类概念已经被证明是一种极为强有力的概念工具。</p><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.2.html" class="" aria-label="1.2 学习C++"><!--[--><!--]--> 1.2 学习C++ <!--[--><!--]--></a></span><span class="next"><a href="/The-C-Plus-Plus-Programming-Language/Introduction/1.4.html" class="" aria-label="1.4 历史注记"><!--[--><!--]--> 1.4 历史注记 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/The-C-Plus-Plus-Programming-Language/assets/app.fce06a0c.js" defer></script>
  </body>
</html>
